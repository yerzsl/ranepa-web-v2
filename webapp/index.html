<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>RANEPA.SYSTEM</title>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
        }

        :root {
            --primary: #dc2626;
            --primary-dark: #b91c1c;
            --primary-light: #fef2f2;
            --bg-primary: #000000;
            --bg-secondary: #111111;
            --bg-card: #1a1a1a;
            --text-primary: #ffffff;
            --text-secondary: #a0a0a0;
            --border: #333333;
            --shadow: 0 4px 20px rgba(220, 38, 38, 0.15);
            --shadow-card: 0 8px 30px rgba(220, 38, 38, 0.1);
            --radius: 20px;
            --radius-sm: 12px;
        }

        body {
            background: linear-gradient(135deg, var(--bg-primary) 0%, var(--bg-secondary) 100%);
            color: var(--text-primary);
            line-height: 1.5;
            min-height: 100vh;
        }

        .container {
            max-width: 400px;
            margin: 0 auto;
            padding: 20px;
            animation: fadeInUp 0.8s ease-out;
        }

        @keyframes fadeInUp {
            from {
                opacity: 0;
                transform: translateY(30px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }

        @keyframes slideInRight {
            from {
                opacity: 0;
                transform: translateX(30px);
            }
            to {
                opacity: 1;
                transform: translateX(0);
            }
        }

        @keyframes pulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.05); }
        }

        @keyframes glow {
            0%, 100% { box-shadow: var(--shadow); }
            50% { box-shadow: 0 4px 30px rgba(220, 38, 38, 0.3); }
        }

        @keyframes float {
            0%, 100% { transform: translateY(0px); }
            50% { transform: translateY(-5px); }
        }

        .header {
            text-align: center;
            margin-bottom: 30px;
            padding-top: 10px;
            animation: fadeInUp 0.6s ease-out 0.1s both;
        }

        .logo {
            font-size: 28px;
            font-weight: 800;
            background: linear-gradient(135deg, var(--primary), #ff6b6b);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            margin-bottom: 8px;
            letter-spacing: -0.5px;
        }

        .subtitle {
            font-size: 14px;
            color: var(--text-secondary);
            font-weight: 500;
        }

        .profile-card {
            background: var(--bg-card);
            border-radius: var(--radius);
            padding: 28px 24px;
            margin-bottom: 25px;
            box-shadow: var(--shadow-card);
            border: 1px solid var(--border);
            text-align: center;
            position: relative;
            overflow: hidden;
            animation: fadeInUp 0.7s ease-out 0.2s both;
            transition: all 0.3s ease;
        }

        .profile-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 3px;
            background: linear-gradient(90deg, var(--primary), var(--primary-dark));
        }

        .profile-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 12px 40px rgba(220, 38, 38, 0.2);
        }

        .avatar {
            width: 90px;
            height: 90px;
            border-radius: 50%;
            background: linear-gradient(135deg, var(--primary), var(--primary-dark));
            margin: 0 auto 20px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 32px;
            color: white;
            font-weight: 700;
            border: 3px solid var(--bg-card);
            box-shadow: 0 0 0 3px var(--primary);
            animation: float 3s ease-in-out infinite;
            transition: all 0.3s ease;
        }

        .avatar:hover {
            animation: pulse 0.5s ease, glow 2s infinite;
        }

        .user-name {
            font-size: 22px;
            font-weight: 700;
            margin-bottom: 6px;
            background: linear-gradient(135deg, #ffffff, #e0e0e0);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        .user-department {
            font-size: 14px;
            color: var(--text-secondary);
            margin-bottom: 20px;
            font-weight: 500;
        }

        .stats {
            display: flex;
            justify-content: space-around;
            border-top: 1px solid var(--border);
            padding-top: 20px;
        }

        .stat-item {
            text-align: center;
            transition: transform 0.3s ease;
        }

        .stat-item:hover {
            transform: scale(1.1);
        }

        .stat-value {
            font-size: 20px;
            font-weight: 800;
            color: var(--primary);
            text-shadow: 0 2px 10px rgba(220, 38, 38, 0.3);
        }

        .stat-label {
            font-size: 12px;
            color: var(--text-secondary);
            margin-top: 6px;
            font-weight: 500;
        }

        .action-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
            margin-bottom: 25px;
            animation: fadeInUp 0.7s ease-out 0.3s both;
        }

        .action-card {
            background: var(--bg-card);
            border-radius: var(--radius);
            padding: 24px 16px;
            text-align: center;
            box-shadow: var(--shadow);
            border: 1px solid var(--border);
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            cursor: pointer;
            position: relative;
            overflow: hidden;
        }

        .action-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(220, 38, 38, 0.1), transparent);
            transition: left 0.6s;
        }

        .action-card:hover::before {
            left: 100%;
        }

        .action-card:hover {
            transform: translateY(-8px) scale(1.02);
            box-shadow: 0 15px 35px rgba(220, 38, 38, 0.2);
            border-color: var(--primary);
        }

        .action-card:active {
            transform: translateY(-2px) scale(1);
        }

        .action-icon {
            font-size: 32px;
            margin-bottom: 12px;
            display: block;
            transition: transform 0.3s ease;
        }

        .action-card:hover .action-icon {
            transform: scale(1.2);
            animation: pulse 1s ease;
        }

        .action-title {
            font-size: 15px;
            font-weight: 700;
            margin-bottom: 6px;
            color: var(--text-primary);
        }

        .action-desc {
            font-size: 11px;
            color: var(--text-secondary);
            line-height: 1.3;
            font-weight: 500;
        }

        .quick-actions {
            background: var(--bg-card);
            border-radius: var(--radius);
            padding: 24px;
            box-shadow: var(--shadow-card);
            border: 1px solid var(--border);
            animation: fadeInUp 0.7s ease-out 0.4s both;
        }

        .section-title {
            font-size: 17px;
            font-weight: 700;
            margin-bottom: 20px;
            display: flex;
            align-items: center;
            justify-content: space-between;
            color: var(--text-primary);
        }

        .section-title::after {
            content: '‚ö°';
            font-size: 14px;
            color: var(--primary);
        }

        .action-list {
            display: flex;
            flex-direction: column;
            gap: 12px;
        }

        .action-item {
            display: flex;
            align-items: center;
            padding: 18px;
            background: var(--bg-secondary);
            border-radius: var(--radius-sm);
            transition: all 0.3s ease;
            cursor: pointer;
            border: 1px solid transparent;
            position: relative;
            overflow: hidden;
        }

        .action-item::before {
            content: '';
            position: absolute;
            left: 0;
            top: 0;
            height: 100%;
            width: 3px;
            background: var(--primary);
            transform: scaleY(0);
            transition: transform 0.3s ease;
        }

        .action-item:hover::before {
            transform: scaleY(1);
        }

        .action-item:hover {
            background: #1f1f1f;
            border-color: var(--primary);
            transform: translateX(8px);
            box-shadow: 0 5px 15px rgba(220, 38, 38, 0.1);
        }

        .action-item:active {
            transform: translateX(4px);
        }

        .action-item-icon {
            width: 44px;
            height: 44px;
            border-radius: 50%;
            background: linear-gradient(135deg, var(--primary), var(--primary-dark));
            display: flex;
            align-items: center;
            justify-content: center;
            margin-right: 16px;
            color: white;
            font-size: 18px;
            flex-shrink: 0;
            transition: all 0.3s ease;
        }

        .action-item:hover .action-item-icon {
            transform: scale(1.1) rotate(5deg);
            animation: glow 2s infinite;
        }

        .action-item-content {
            flex: 1;
        }

        .action-item-title {
            font-size: 15px;
            font-weight: 700;
            margin-bottom: 4px;
            color: var(--text-primary);
        }

        .action-item-desc {
            font-size: 12px;
            color: var(--text-secondary);
            font-weight: 500;
        }

        .status-badge {
            display: inline-block;
            padding: 6px 14px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: 700;
            margin-top: 8px;
            transition: all 0.3s ease;
        }

        .status-new { background: rgba(220, 38, 38, 0.1); color: var(--primary); border: 1px solid var(--primary); }
        .status-accepted { background: rgba(34, 197, 94, 0.1); color: #22c55e; border: 1px solid #22c55e; }
        .status-completed { background: rgba(59, 130, 246, 0.1); color: #3b82f6; border: 1px solid #3b82f6; }

        .form-container {
            background: var(--bg-card);
            border-radius: var(--radius);
            padding: 28px 24px;
            box-shadow: var(--shadow-card);
            border: 1px solid var(--border);
            animation: slideInRight 0.6s ease-out;
        }

        .form-group {
            margin-bottom: 20px;
        }

        .form-label {
            display: block;
            font-size: 14px;
            font-weight: 700;
            margin-bottom: 10px;
            color: var(--text-primary);
        }

        .form-input, .form-select, .form-textarea {
            width: 100%;
            padding: 16px;
            background: var(--bg-secondary);
            border: 1px solid var(--border);
            border-radius: var(--radius-sm);
            font-size: 16px;
            color: var(--text-primary);
            transition: all 0.3s ease;
        }

        .form-input:focus, .form-select:focus, .form-textarea:focus {
            outline: none;
            border-color: var(--primary);
            box-shadow: 0 0 0 3px rgba(220, 38, 38, 0.1);
            transform: translateY(-2px);
        }

        .form-textarea {
            height: 120px;
            resize: none;
        }

        .btn-primary {
            width: 100%;
            padding: 18px;
            background: linear-gradient(135deg, var(--primary), var(--primary-dark));
            color: white;
            border: none;
            border-radius: var(--radius-sm);
            font-size: 16px;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }

        .btn-primary::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.2), transparent);
            transition: left 0.6s;
        }

        .btn-primary:hover::before {
            left: 100%;
        }

        .btn-primary:hover {
            transform: translateY(-3px);
            box-shadow: 0 10px 25px rgba(220, 38, 38, 0.3);
        }

        .btn-primary:active {
            transform: translateY(-1px);
        }

        .btn-secondary {
            width: 100%;
            padding: 16px;
            background: transparent;
            color: var(--text-secondary);
            border: 1px solid var(--border);
            border-radius: var(--radius-sm);
            font-size: 16px;
            margin-top: 12px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .btn-secondary:hover {
            border-color: var(--primary);
            color: var(--primary);
            transform: translateY(-2px);
        }

        .text-center { text-align: center; }
        .mb-20 { margin-bottom: 20px; }
        .hidden { 
            display: none; 
            animation: fadeOut 0.3s ease-out;
        }

        @keyframes fadeOut {
            from { opacity: 1; }
            to { opacity: 0; }
        }

        .loading {
            display: inline-block;
            width: 20px;
            height: 20px;
            border: 3px solid rgba(255, 255, 255, 0.3);
            border-radius: 50%;
            border-top-color: var(--primary);
            animation: spin 1s ease-in-out infinite;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        .applications-list {
            display: flex;
            flex-direction: column;
            gap: 12px;
            margin-top: 20px;
        }

        .application-card {
            background: var(--bg-card);
            border-radius: var(--radius-sm);
            padding: 16px;
            border: 1px solid var(--border);
            transition: all 0.3s ease;
        }

        .application-card:hover {
            border-color: var(--primary);
            transform: translateX(5px);
        }

        .application-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 8px;
        }

        .application-id {
            font-weight: 700;
            color: var(--primary);
        }

        .application-audience {
            color: var(--text-secondary);
            font-size: 14px;
        }

        .application-problem {
            margin-bottom: 8px;
            font-size: 14px;
        }

        .application-footer {
            display: flex;
            justify-content: space-between;
            align-items: center;
            font-size: 12px;
            color: var(--text-secondary);
        }

        .empty-state {
            text-align: center;
            padding: 40px 20px;
            color: var(--text-secondary);
        }

        .empty-state-icon {
            font-size: 48px;
            margin-bottom: 16px;
            opacity: 0.5;
        }
    </style>
</head>
<body>
    <div class="container" id="mainScreen">
        <div class="header">
            <div class="logo">RANEPA.SYSTEM</div>
            <div class="subtitle">–¢–µ—Ö–Ω–∏—á–µ—Å–∫–∞—è –ø–æ–¥–¥–µ—Ä–∂–∫–∞</div>
        </div>

        <div class="profile-card">
            <div class="avatar" id="userAvatar">–ò–ò</div>
            <div class="user-name" id="userName">–ó–∞–≥—Ä—É–∑–∫–∞...</div>
            <div class="user-department" id="userDepartment">–ó–∞–≥—Ä—É–∑–∫–∞...</div>
            <div class="stats">
                <div class="stat-item">
                    <div class="stat-value" id="totalApps">0</div>
                    <div class="stat-label">–í—Å–µ–≥–æ</div>
                </div>
                <div class="stat-item">
                    <div class="stat-value" id="activeApps">0</div>
                    <div class="stat-label">–ê–∫—Ç–∏–≤–Ω—ã–µ</div>
                </div>
                <div class="stat-item">
                    <div class="stat-value" id="completedApps">0</div>
                    <div class="stat-label">–ó–∞–≤–µ—Ä—à–µ–Ω–æ</div>
                </div>
            </div>
        </div>

        <div class="action-grid">
            <div class="action-card" onclick="showCreateForm()">
                <div class="action-icon">üìù</div>
                <div class="action-title">–ù–æ–≤–∞—è –∑–∞—è–≤–∫–∞</div>
                <div class="action-desc">–°–æ–∑–¥–∞—Ç—å –∑–∞–ø—Ä–æ—Å –Ω–∞ –ø–æ–¥–¥–µ—Ä–∂–∫—É</div>
            </div>
            <div class="action-card" onclick="showMyApplications()">
                <div class="action-icon">üìã</div>
                <div class="action-title">–ú–æ–∏ –∑–∞—è–≤–∫–∏</div>
                <div class="action-desc">–ò—Å—Ç–æ—Ä–∏—è –∏ —Å—Ç–∞—Ç—É—Å—ã</div>
            </div>
        </div>

        <div class="quick-actions">
            <div class="section-title">–ë—ã—Å—Ç—Ä—ã–µ –¥–µ–π—Å—Ç–≤–∏—è</div>
            <div class="action-list">
                <div class="action-item" onclick="showFAQ()">
                    <div class="action-item-icon">‚ùì</div>
                    <div class="action-item-content">
                        <div class="action-item-title">FAQ & –ü–æ–º–æ—â—å</div>
                        <div class="action-item-desc">–û—Ç–≤–µ—Ç—ã –Ω–∞ —á–∞—Å—Ç—ã–µ –≤–æ–ø—Ä–æ—Å—ã</div>
                    </div>
                </div>
                <div class="action-item" onclick="showEquipmentStats()">
                    <div class="action-item-icon">üìä</div>
                    <div class="action-item-content">
                        <div class="action-item-title">–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞</div>
                        <div class="action-item-desc">–ê–Ω–∞–ª–∏—Ç–∏–∫–∞ –æ–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏—è</div>
                    </div>
                </div>
                <div class="action-item" onclick="showFeedback()">
                    <div class="action-item-icon">üí¨</div>
                    <div class="action-item-content">
                        <div class="action-item-title">–û–±—Ä–∞—Ç–Ω–∞—è —Å–≤—è–∑—å</div>
                        <div class="action-item-desc">–ü—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è –∏ –≤–æ–ø—Ä–æ—Å—ã</div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div id="createForm" class="container hidden">
        <div class="header">
            <div class="logo">–ù–æ–≤–∞—è –∑–∞—è–≤–∫–∞</div>
            <div class="subtitle">–û–ø–∏—à–∏—Ç–µ –≤–∞—à—É –ø—Ä–æ–±–ª–µ–º—É</div>
        </div>

        <div class="form-container">
            <div class="form-group">
                <label class="form-label">–ê—É–¥–∏—Ç–æ—Ä–∏—è *</label>
                <input type="text" id="audienceInput" class="form-input" placeholder="–ù–∞–ø—Ä–∏–º–µ—Ä, 301" maxlength="10" required>
            </div>

            <div class="form-group">
                <label class="form-label">–¢–∏–ø –ø–æ–º–æ—â–∏</label>
                <select id="helpType" class="form-select">
                    <option value="üîß –ü–æ–º–æ—â—å –≤ –æ—á–Ω–æ–π —Ñ–æ—Ä–º–µ">üîß –ü–æ–º–æ—â—å –≤ –æ—á–Ω–æ–π —Ñ–æ—Ä–º–µ</option>
                    <option value="üíª –î–∏—Å—Ç–∞–Ω—Ü–∏–æ–Ω–Ω–∞—è –ø–æ–º–æ—â—å">üíª –î–∏—Å—Ç–∞–Ω—Ü–∏–æ–Ω–Ω–∞—è –ø–æ–º–æ—â—å</option>
                </select>
            </div>

            <div class="form-group">
                <label class="form-label">–ö–∞—Ç–µ–≥–æ—Ä–∏—è –ø—Ä–æ–±–ª–µ–º—ã</label>
                <select id="problemCategory" class="form-select" onchange="onCategoryChange()">
                    <option value="üíª –ö–æ–º–ø—å—é—Ç–µ—Ä">üíª –ö–æ–º–ø—å—é—Ç–µ—Ä</option>
                    <option value="üåê –ò–Ω—Ç–µ—Ä–Ω–µ—Ç">üåê –ò–Ω—Ç–µ—Ä–Ω–µ—Ç</option>
                    <option value="üñ®Ô∏è –ü—Ä–∏–Ω—Ç–µ—Ä">üñ®Ô∏è –ü—Ä–∏–Ω—Ç–µ—Ä</option>
                    <option value="üì∫ –ü—Ä–æ–µ–∫—Ç–æ—Ä/–¢–µ–ª–µ–≤–∏–∑–æ—Ä">üì∫ –ü—Ä–æ–µ–∫—Ç–æ—Ä/–¢–µ–ª–µ–≤–∏–∑–æ—Ä</option>
                    <option value="‚öôÔ∏è –ü—Ä–æ–≥—Ä–∞–º–º–Ω–æ–µ –æ–±–µ—Å–ø–µ—á–µ–Ω–∏–µ">‚öôÔ∏è –ü—Ä–æ–≥—Ä–∞–º–º–Ω–æ–µ –æ–±–µ—Å–ø–µ—á–µ–Ω–∏–µ</option>
                    <option value="üé§ –ê—É–¥–∏–æ">üé§ –ê—É–¥–∏–æ</option>
                    <option value="‚ùì –î—Ä—É–≥–æ–µ">‚ùì –î—Ä—É–≥–æ–µ</option>
                </select>
            </div>

            <div class="form-group" id="subcategoryGroup" style="display: none;">
                <label class="form-label">–¢–∏–ø –ø—Ä–æ–±–ª–µ–º—ã</label>
                <select id="problemSubcategory" class="form-select">
                </select>
            </div>

            <div class="form-group">
                <label class="form-label">–û–ø–∏—Å–∞–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º—ã *</label>
                <textarea id="problemDescription" class="form-textarea" placeholder="–ü–æ–¥—Ä–æ–±–Ω–æ –æ–ø–∏—à–∏—Ç–µ –ø—Ä–æ–±–ª–µ–º—É..." required></textarea>
            </div>

            <button class="btn-primary" onclick="submitApplication()" id="submitBtn">
                <span id="submitText">üì® –û—Ç–ø—Ä–∞–≤–∏—Ç—å –∑–∞—è–≤–∫—É</span>
                <span id="submitLoading" class="hidden" style="display: inline-flex; align-items: center; justify-content: center;">
                    <div class="loading" style="margin-right: 8px;"></div>
                    –û—Ç–ø—Ä–∞–≤–∫–∞...
                </span>
            </button>
            <button class="btn-secondary" onclick="showMainScreen()">‚Üê –ù–∞–∑–∞–¥</button>
        </div>
    </div>

    <div id="applicationsScreen" class="container hidden">
        <div class="header">
            <div class="logo">–ú–æ–∏ –∑–∞—è–≤–∫–∏</div>
            <div class="subtitle">–ò—Å—Ç–æ—Ä–∏—è –≤–∞—à–∏—Ö –æ–±—Ä–∞—â–µ–Ω–∏–π</div>
        </div>

        <div class="form-container">
            <div id="applicationsList" class="applications-list">
            </div>
            <button class="btn-secondary" onclick="showMainScreen()" style="margin-top: 20px;">‚Üê –ù–∞ –≥–ª–∞–≤–Ω—É—é</button>
        </div>
    </div>

    <div id="faqScreen" class="container hidden">
        <div class="header">
            <div class="logo">FAQ & –ü–æ–º–æ—â—å</div>
            <div class="subtitle">–ß–∞—Å—Ç–æ –∑–∞–¥–∞–≤–∞–µ–º—ã–µ –≤–æ–ø—Ä–æ—Å—ã</div>
        </div>

        <div class="form-container">
            <div class="action-list">
                <div class="action-item" onclick="showFAQCategory('computer')">
                    <div class="action-item-icon">üíª</div>
                    <div class="action-item-content">
                        <div class="action-item-title">–ü—Ä–æ–±–ª–µ–º—ã —Å –∫–æ–º–ø—å—é—Ç–µ—Ä–æ–º</div>
                        <div class="action-item-desc">–ù–µ –≤–∫–ª—é—á–∞–µ—Ç—Å—è, –º–µ–¥–ª–µ–Ω–Ω–∞—è —Ä–∞–±–æ—Ç–∞</div>
                    </div>
                </div>
                <div class="action-item" onclick="showFAQCategory('internet')">
                    <div class="action-item-icon">üåê</div>
                    <div class="action-item-content">
                        <div class="action-item-title">–ü—Ä–æ–±–ª–µ–º—ã —Å –∏–Ω—Ç–µ—Ä–Ω–µ—Ç–æ–º</div>
                        <div class="action-item-desc">–ù–µ—Ç –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è, –º–µ–¥–ª–µ–Ω–Ω–∞—è —Å–∫–æ—Ä–æ—Å—Ç—å</div>
                    </div>
                </div>
                <div class="action-item" onclick="showFAQCategory('printer')">
                    <div class="action-item-icon">üñ®Ô∏è</div>
                    <div class="action-item-content">
                        <div class="action-item-title">–ü—Ä–æ–±–ª–µ–º—ã —Å –ø—Ä–∏–Ω—Ç–µ—Ä–æ–º</div>
                        <div class="action-item-desc">–ù–µ –ø–µ—á–∞—Ç–∞–µ—Ç, –∑–∞–º—è—Ç–∏–µ –±—É–º–∞–≥–∏</div>
                    </div>
                </div>
                <div class="action-item" onclick="showFAQCategory('projector')">
                    <div class="action-item-icon">üì∫</div>
                    <div class="action-item-content">
                        <div class="action-item-title">–ü—Ä–æ–±–ª–µ–º—ã —Å –ø—Ä–æ–µ–∫—Ç–æ—Ä–æ–º</div>
                        <div class="action-item-desc">–ù–µ—Ç –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è, –Ω–µ—Ç –∑–≤—É–∫–∞</div>
                    </div>
                </div>
            </div>
            <button class="btn-secondary" onclick="showMainScreen()" style="margin-top: 20px;">‚Üê –ù–∞–∑–∞–¥</button>
        </div>
    </div>

    <script>
        const problemSubcategories = {
            'üíª –ö–æ–º–ø—å—é—Ç–µ—Ä': ['–ù–µ –≤–∫–ª—é—á–∞–µ—Ç—Å—è', '–ú–µ–¥–ª–µ–Ω–Ω–æ —Ä–∞–±–æ—Ç–∞–µ—Ç', '–°–∏–Ω–∏–π —ç–∫—Ä–∞–Ω', '–ü–µ—Ä–µ–≥—Ä–µ–≤–∞–µ—Ç—Å—è', '–î—Ä—É–≥–æ–µ'],
            'üåê –ò–Ω—Ç–µ—Ä–Ω–µ—Ç': ['–ù–µ—Ç –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è', '–ú–µ–¥–ª–µ–Ω–Ω–∞—è —Å–∫–æ—Ä–æ—Å—Ç—å', '–ù–µ—Å—Ç–∞–±–∏–ª—å–Ω–æ–µ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ', 'Wi-Fi –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç', '–î—Ä—É–≥–æ–µ'],
            'üñ®Ô∏è –ü—Ä–∏–Ω—Ç–µ—Ä': ['–ù–µ –ø–µ—á–∞—Ç–∞–µ—Ç', '–ó–∞–º—è—Ç–∏–µ –±—É–º–∞–≥–∏', '–ë–ª–µ–¥–Ω–∞—è –ø–µ—á–∞—Ç—å', '–ó–∞–º–µ–Ω–∞ –∫–∞—Ä—Ç—Ä–∏–¥–∂–∞', '–°–∫–∞–Ω–µ—Ä –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç'],
            'üì∫ –ü—Ä–æ–µ–∫—Ç–æ—Ä/–¢–µ–ª–µ–≤–∏–∑–æ—Ä': ['–ù–µ—Ç –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è', '–ù–µ—Ç –∑–≤—É–∫–∞', '–ü–µ—Ä–µ–≥—Ä–µ–≤', '–ù–µ –≤–∫–ª—é—á–∞–µ—Ç—Å—è', '–î—Ä—É–≥–æ–µ'],
            '‚öôÔ∏è –ü—Ä–æ–≥—Ä–∞–º–º–Ω–æ–µ –æ–±–µ—Å–ø–µ—á–µ–Ω–∏–µ': ['–ù–µ —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç—Å—è', '–ù–µ –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è', '–û—à–∏–±–∫–∞ –ø—Ä–∏ —Ä–∞–±–æ—Ç–µ', '–¢—Ä–µ–±—É–µ—Ç—Å—è –ª–∏—Ü–µ–Ω–∑–∏—è', '–î—Ä—É–≥–æ–µ'],
            'üé§ –ê—É–¥–∏–æ': ['–ù–µ—Ç –∑–≤—É–∫–∞', '–®—É–º—ã/–ø–æ–º–µ—Ö–∏', '–ù–µ —Ä–∞–±–æ—Ç–∞—é—Ç –∫–æ–ª–æ–Ω–∫–∏', '–ü—Ä–æ–±–ª–µ–º—ã —Å –º–∏–∫—Ä–æ—Ñ–æ–Ω–æ–º', '–î—Ä—É–≥–æ–µ']
        };

        let tg = window.Telegram.WebApp;
        tg.expand();
        tg.ready();

        let currentUser = null;
        let userApplications = [];

        document.addEventListener('DOMContentLoaded', function() {
            initApp();
        });

        async function initApp() {
            try {
                const telegramUser = tg.initDataUnsafe.user;
                
                if (!telegramUser) {
                    showError('–ù–µ —É–¥–∞–ª–æ—Å—å –ø–æ–ª—É—á–∏—Ç—å –¥–∞–Ω–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è');
                    return;
                }

                currentUser = await registerUser(telegramUser);
                
                if (currentUser) {
                    initUserProfile(currentUser);
                    await loadUserStats();
                    await loadUserApplications();
                }
            } catch (error) {
                console.error('–û—à–∏–±–∫–∞ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏:', error);
                showError('–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è');
            }
        }

        async function registerUser(telegramUser) {
            try {
                const API_BASE = window.location.origin;
                const response = await fetch(`${API_BASE}/api/register`, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({
                        user_id: telegramUser.id,
                        first_name: telegramUser.first_name,
                        last_name: telegramUser.last_name,
                        username: telegramUser.username
                    })
                });

                if (response.ok) {
                    return await response.json();
                } else {
                    throw new Error('–û—à–∏–±–∫–∞ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏');
                }
            } catch (error) {
                console.error('–û—à–∏–±–∫–∞ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏:', error);
                return {
                    user_id: telegramUser.id,
                    user_name: [telegramUser.first_name, telegramUser.last_name].filter(Boolean).join(' ') || '–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å',
                    user_department: '–û—Ç–¥–µ–ª –Ω–µ —É–∫–∞–∑–∞–Ω'
                };
            }
        }

        function initUserProfile(user) {
            const firstName = user.user_name.split(' ')[0] || '';
            const lastName = user.user_name.split(' ')[1] || '';
            const initials = (firstName.charAt(0) + (lastName ? lastName.charAt(0) : '')).toUpperCase() || 'TU';
            document.getElementById('userAvatar').textContent = initials;
            
            document.getElementById('userName').textContent = user.user_name;
            document.getElementById('userDepartment').textContent = user.user_department || '–ù–µ —É–∫–∞–∑–∞–Ω';
        }

        async function loadUserStats() {
            try {
                if (!currentUser) return;

                const API_BASE = window.location.origin;
                const response = await fetch(`${API_BASE}/api/user-stats/${currentUser.user_id}`);
                
                if (response.ok) {
                    const stats = await response.json();
                    updateStatsDisplay(stats);
                } else {
                    updateStatsDisplay({
                        total: userApplications.length,
                        active: userApplications.filter(app => app.status === 'new' || app.status === 'accepted').length,
                        completed: userApplications.filter(app => app.status === 'completed').length
                    });
                }
            } catch (error) {
                console.error('–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏:', error);
                updateStatsDisplay({
                    total: 0,
                    active: 0,
                    completed: 0
                });
            }
        }

        function updateStatsDisplay(stats) {
            document.getElementById('totalApps').textContent = stats.total || 0;
            document.getElementById('activeApps').textContent = stats.active || 0;
            document.getElementById('completedApps').textContent = stats.completed || 0;
        }

        async function loadUserApplications() {
            try {
                if (!currentUser) return;

                const API_BASE = window.location.origin;
                const response = await fetch(`${API_BASE}/api/user-applications/${currentUser.user_id}`);
                
                if (response.ok) {
                    userApplications = await response.json();
                } else {
                    userApplications = [];
                }
            } catch (error) {
                console.error('–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –∑–∞—è–≤–æ–∫:', error);
                userApplications = [];
            }
        }

        function onCategoryChange() {
            const category = document.getElementById('problemCategory').value;
            const subcategoryGroup = document.getElementById('subcategoryGroup');
            const subcategorySelect = document.getElementById('problemSubcategory');

            if (problemSubcategories[category] && category !== '‚ùì –î—Ä—É–≥–æ–µ') {
                subcategorySelect.innerHTML = '';
                problemSubcategories[category].forEach(subcat => {
                    const option = document.createElement('option');
                    option.value = subcat;
                    option.textContent = subcat;
                    subcategorySelect.appendChild(option);
                });
                subcategoryGroup.style.display = 'block';
            } else {
                subcategoryGroup.style.display = 'none';
            }
        }

        async function submitApplication() {
            const audience = document.getElementById('audienceInput').value.trim();
            const helpType = document.getElementById('helpType').value;
            const problemCategory = document.getElementById('problemCategory').value;
            const problemSubcategory = document.getElementById('problemSubcategory').value;
            const description = document.getElementById('problemDescription').value.trim();

            if (!audience || !description) {
                showError('–ó–∞–ø–æ–ª–Ω–∏—Ç–µ –≤—Å–µ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ –ø–æ–ª—è');
                return;
            }

            let problemText = problemCategory;
            if (problemSubcategory && problemCategory !== '‚ùì –î—Ä—É–≥–æ–µ') {
                problemText += `: ${problemSubcategory}`;
            }
            problemText += ` - ${description}`;

            document.getElementById('submitText').classList.add('hidden');
            document.getElementById('submitLoading').classList.remove('hidden');

            try {
                const API_BASE = window.location.origin;
                const response = await fetch(`${API_BASE}/api/create-application`, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({
                        user_id: currentUser.user_id,
                        audience: audience,
                        problem: problemText,
                        help_type: helpType
                    })
                });

                if (response.ok) {
                    const result = await response.json();
                    
                    tg.showPopup({
                        title: 'üéâ –£—Å–ø–µ—à–Ω–æ!',
                        message: `–ó–∞—è–≤–∫–∞ #${result.application_id} —Å–æ–∑–¥–∞–Ω–∞!\n–°–ø–µ—Ü–∏–∞–ª–∏—Å—Ç —Å–≤—è–∂–µ—Ç—Å—è —Å –≤–∞–º–∏.`,
                        buttons: [{ type: 'ok', text: '–û—Ç–ª–∏—á–Ω–æ' }]
                    });

                    await loadUserStats();
                    await loadUserApplications();

                    resetForm();
                    showMainScreen();
                    
                } else {
                    throw new Error('–û—à–∏–±–∫–∞ —Å–æ–∑–¥–∞–Ω–∏—è –∑–∞—è–≤–∫–∏');
                }
            } catch (error) {
                console.error('–û—à–∏–±–∫–∞ –æ—Ç–ø—Ä–∞–≤–∫–∏ –∑–∞—è–≤–∫–∏:', error);
                showError('–û—à–∏–±–∫–∞ –ø—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ –∑–∞—è–≤–∫–∏. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –µ—â–µ —Ä–∞–∑.');
            } finally {
                document.getElementById('submitText').classList.remove('hidden');
                document.getElementById('submitLoading').classList.add('hidden');
            }
        }

        function resetForm() {
            document.getElementById('audienceInput').value = '';
            document.getElementById('problemDescription').value = '';
            document.getElementById('problemCategory').selectedIndex = 0;
            document.getElementById('subcategoryGroup').style.display = 'none';
        }

        function showMyApplications() {
            document.getElementById('mainScreen').classList.add('hidden');
            setTimeout(() => {
                document.getElementById('applicationsScreen').classList.remove('hidden');
                displayApplicationsList();
            }, 50);
        }

        function displayApplicationsList() {
            const container = document.getElementById('applicationsList');
            
            if (!userApplications || userApplications.length === 0) {
                container.innerHTML = `
                    <div class="empty-state">
                        <div class="empty-state-icon">üìã</div>
                        <div>–£ –≤–∞—Å –ø–æ–∫–∞ –Ω–µ—Ç –∑–∞—è–≤–æ–∫</div>
                        <div style="margin-top: 8px; font-size: 14px;">–°–æ–∑–¥–∞–π—Ç–µ –ø–µ—Ä–≤—É—é –∑–∞—è–≤–∫—É!</div>
                    </div>
                `;
                return;
            }

            container.innerHTML = userApplications.map(app => `
                <div class="application-card">
                    <div class="application-header">
                        <div class="application-id">#${app.id}</div>
                        <div class="application-audience">${app.audience}</div>
                    </div>
                    <div class="application-problem">${app.problem}</div>
                    <div class="application-footer">
                        <div class="status-badge status-${app.status}">
                            ${getStatusText(app.status)}
                        </div>
                        <div>${formatDate(app.created_date)}</div>
                    </div>
                    ${app.specialist_name ? `<div style="margin-top: 8px; font-size: 12px; color: var(--text-secondary);">üë®‚Äçüíº ${app.specialist_name}</div>` : ''}
                </div>
            `).join('');
        }

        function getStatusText(status) {
            const statusMap = {
                'new': 'üÜï –ù–æ–≤–∞—è',
                'accepted': 'üõ†Ô∏è –í —Ä–∞–±–æ—Ç–µ', 
                'completed': '‚úÖ –ó–∞–≤–µ—Ä—à–µ–Ω–∞',
                'rejected': '‚ùå –û—Ç–∫–ª–æ–Ω–µ–Ω–∞'
            };
            return statusMap[status] || status;
        }

        function formatDate(dateString) {
            const date = new Date(dateString);
            return date.toLocaleDateString('ru-RU', {
                day: '2-digit',
                month: '2-digit',
                year: 'numeric'
            });
        }

        function showFAQ() {
            document.getElementById('mainScreen').classList.add('hidden');
            setTimeout(() => {
                document.getElementById('faqScreen').classList.remove('hidden');
            }, 50);
        }

        function showFAQCategory(category) {
            const faqData = {
                computer: {
                    title: 'üíª –ü—Ä–æ–±–ª–µ–º—ã —Å –∫–æ–º–ø—å—é—Ç–µ—Ä–æ–º',
                    content: `‚Ä¢ –ù–µ –≤–∫–ª—é—á–∞–µ—Ç—Å—è: –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø–∏—Ç–∞–Ω–∏–µ, –∫–∞–±–µ–ª–∏, –∫–Ω–æ–ø–∫—É –≤–∫–ª—é—á–µ–Ω–∏—è\n‚Ä¢ –ú–µ–¥–ª–µ–Ω–Ω–∞—è —Ä–∞–±–æ—Ç–∞: –ó–∞–∫—Ä–æ–π—Ç–µ –ª–∏—à–Ω–∏–µ –ø—Ä–æ–≥—Ä–∞–º–º—ã, –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∏—Ç–µ –∫–æ–º–ø—å—é—Ç–µ—Ä  \n‚Ä¢ –°–∏–Ω–∏–π —ç–∫—Ä–∞–Ω: –ó–∞–ø–∏—à–∏—Ç–µ –∫–æ–¥ –æ—à–∏–±–∫–∏ –∏ —Å–æ–æ–±—â–∏—Ç–µ —Å–ø–µ—Ü–∏–∞–ª–∏—Å—Ç—É\n‚Ä¢ –ü–µ—Ä–µ–≥—Ä–µ–≤–∞–µ—Ç—Å—è: –û–±–µ—Å–ø–µ—á—å—Ç–µ –≤–µ–Ω—Ç–∏–ª—è—Ü–∏—é, –ø–æ—á–∏—Å—Ç–∏—Ç–µ –æ—Ç –ø—ã–ª–∏`
                },
                internet: {
                    title: 'üåê –ü—Ä–æ–±–ª–µ–º—ã —Å –∏–Ω—Ç–µ—Ä–Ω–µ—Ç–æ–º',
                    content: `‚Ä¢ –ù–µ—Ç –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è: –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –∫–∞–±–µ–ª—å Wi-Fi, –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∏—Ç–µ —Ä–æ—É—Ç–µ—Ä\n‚Ä¢ –ú–µ–¥–ª–µ–Ω–Ω–∞—è —Å–∫–æ—Ä–æ—Å—Ç—å: –ó–∞–∫—Ä–æ–π—Ç–µ —Ç–æ—Ä—Ä–µ–Ω—Ç—ã, –≤–∏–¥–µ–æ –≤ HD –∫–∞—á–µ—Å—Ç–≤–µ\n‚Ä¢ –ù–µ—Å—Ç–∞–±–∏–ª—å–Ω–æ–µ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ: –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Ä–∞—Å–ø–æ–ª–æ–∂–µ–Ω–∏–µ —Ä–æ—É—Ç–µ—Ä–∞\n‚Ä¢ Wi-Fi –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç: –ü–µ—Ä–µ–ø–æ–¥–∫–ª—é—á–∏—Ç–µ—Å—å –∫ —Å–µ—Ç–∏, –ø—Ä–æ–≤–µ—Ä—å—Ç–µ –ø–∞—Ä–æ–ª—å`
                },
                printer: {
                    title: 'üñ®Ô∏è –ü—Ä–æ–±–ª–µ–º—ã —Å –ø—Ä–∏–Ω—Ç–µ—Ä–æ–º',
                    content: `‚Ä¢ –ù–µ –ø–µ—á–∞—Ç–∞–µ—Ç: –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –±—É–º–∞–≥—É, –∫–∞—Ä—Ç—Ä–∏–¥–∂–∏, –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ —Å–µ—Ç–∏\n‚Ä¢ –ó–∞–º—è—Ç–∏–µ –±—É–º–∞–≥–∏: –ê–∫–∫—É—Ä–∞—Ç–Ω–æ –∏–∑–≤–ª–µ–∫–∏—Ç–µ –±—É–º–∞–≥—É –ø–æ —Å—Ç—Ä–µ–ª–∫–µ\n‚Ä¢ –ë–ª–µ–¥–Ω–∞—è –ø–µ—á–∞—Ç—å: –ó–∞–º–µ–Ω–∏—Ç–µ –∫–∞—Ä—Ç—Ä–∏–¥–∂\n‚Ä¢ –°–∫–∞–Ω–µ—Ä –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç: –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ, –¥—Ä–∞–π–≤–µ—Ä—ã`
                },
                projector: {
                    title: 'üì∫ –ü—Ä–æ–±–ª–µ–º—ã —Å –ø—Ä–æ–µ–∫—Ç–æ—Ä–æ–º',
                    content: `‚Ä¢ –ù–µ—Ç –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è: –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –∫–∞–±–µ–ª—å HDMI/VGA, –∏—Å—Ç–æ—á–Ω–∏–∫ —Å–∏–≥–Ω–∞–ª–∞\n‚Ä¢ –ù–µ—Ç –∑–≤—É–∫–∞: –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –≥—Ä–æ–º–∫–æ—Å—Ç—å, –∞—É–¥–∏–æ–∫–∞–±–µ–ª—å\n‚Ä¢ –ü–µ—Ä–µ–≥—Ä–µ–≤: –î–∞–π—Ç–µ –æ—Å—Ç—ã—Ç—å 30 –º–∏–Ω—É—Ç\n‚Ä¢ –ù–µ –≤–∫–ª—é—á–∞–µ—Ç—Å—è: –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø–∏—Ç–∞–Ω–∏–µ, –ø—É–ª—å—Ç –î–£`
                }
            };

            const data = faqData[category];
            if (data) {
                tg.showPopup({
                    title: data.title,
                    message: data.content,
                    buttons: [{ type: 'ok', text: '–ü–æ–Ω—è—Ç–Ω–æ' }]
                });
            }
        }

        function showEquipmentStats() {
            tg.showPopup({
                title: 'üìä –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –æ–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏—è',
                message: '–≠—Ç–∞ —Ñ—É–Ω–∫—Ü–∏—è –¥–æ—Å—Ç—É–ø–Ω–∞ —Å–ø–µ—Ü–∏–∞–ª–∏—Å—Ç–∞–º –≤ –æ—Å–Ω–æ–≤–Ω–æ–º –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–µ –±–æ—Ç–∞.',
                buttons: [{ type: 'ok', text: '–Ø—Å–Ω–æ' }]
            });
        }

        function showFeedback() {
            tg.showPopup({
                title: 'üí¨ –û–±—Ä–∞—Ç–Ω–∞—è —Å–≤—è–∑—å',
                message: '–ü–æ –≤–æ–ø—Ä–æ—Å–∞–º –∏ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è–º –æ–±—Ä–∞—â–∞–π—Ç–µ—Å—å –≤ —á–∞—Ç –æ–±—Ä–∞—Ç–Ω–æ–π —Å–≤—è–∑–∏.',
                buttons: [{ type: 'ok', text: '–û–ö' }]
            });
        }

        function showMainScreen() {
            document.querySelectorAll('.container').forEach(container => {
                container.classList.add('hidden');
            });
            
            setTimeout(() => {
                document.getElementById('mainScreen').classList.remove('hidden');
            }, 50);
        }

        function showCreateForm() {
            document.getElementById('mainScreen').classList.add('hidden');
            setTimeout(() => {
                document.getElementById('createForm').classList.remove('hidden');
            }, 50);
        }

        function showError(message) {
            tg.showPopup({
                title: '‚ö†Ô∏è –û—à–∏–±–∫–∞',
                message: message,
                buttons: [{ type: 'ok', text: '–ü–æ–Ω—è—Ç–Ω–æ' }]
            });
        }

        tg.onEvent('themeChanged', function() {
            if (tg.colorScheme === 'dark') {
                document.documentElement.style.setProperty('--bg-primary', '#000000');
                document.documentElement.style.setProperty('--bg-secondary', '#111111');
            } else {
                document.documentElement.style.setProperty('--bg-primary', '#ffffff');
                document.documentElement.style.setProperty('--bg-secondary', '#f8f9fa');
                document.documentElement.style.setProperty('--bg-card', '#ffffff');
                document.documentElement.style.setProperty('--text-primary', '#1a1a1a');
                document.documentElement.style.setProperty('--text-secondary', '#666666');
                document.documentElement.style.setProperty('--border', '#e0e0e0');
            }
        });
    </script>
</body>
</html>